<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Survey Data Analysis</title>
    <meta charset="utf-8" />
    <meta name="date" content="2021-12-01" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <script src="https://use.fontawesome.com/5235085b15.js"></script>
    <link rel="stylesheet" href="unhcr-slides.css" type="text/css" />
    <link rel="stylesheet" href="unhcr-slides-fonts.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Survey Data Analysis
## <code>&lt;font color=“black”, size = 30&gt;Cookbook</font></code>
### 
### 1 December 2021

---

layout: true

&lt;div class="my-footer"&gt;&lt;span&gt;&lt;/span&gt;&lt;/div&gt; 






---
class: inverse, left, middle

# A Vision for Data Analysis

&lt;span style='font-size:50px; color:grey15;'&gt;"_Multi-functional teams, with strengthened data literacy, regularly conduct meaningful and documented joint data interpretation sessions to define their strategic directions based on statistical evidences_"&lt;/span&gt;


???
Slides made with Xaringan - - https://arm.rbind.io/slides/xaringan.html

---

# A Theory of Change for Data analysis

&lt;span style='font-size:30px;'&gt;Proper use of data for advocacy &amp; programmatic decision making &lt;/span&gt;

 &lt;span style='font-size:40px;'&gt;&amp;#8618;&lt;/span&gt; Corporate __Standards__ exist to define how to encode &amp; process household surveys dataset

 &lt;span style='font-size:40px;'&gt;&amp;#8618;&lt;/span&gt; Field data experts are trained based on precise recipes and predefined tools at each step of the __data life cycle__


 &lt;span style='font-size:40px;'&gt;&amp;#8618;&lt;/span&gt; Data are presented, discussed and linked to expert knowledge during data __interpretation__ sessions with a multi-functional team


 &lt;span style='font-size:40px;'&gt;&amp;#8618;&lt;/span&gt; All potential valid interpretations, including diverging views, are systematically __recorded__

 &lt;span style='font-size:40px;'&gt;&amp;#8618;&lt;/span&gt;  __Persuasive__ "Data Stories“ and Policy papers are generated

---

class: left, middle

# Learning objectives

### 1. How to build charts quickly?

### 2. How to calculate impact indicators from survey data? 

### 3. How to answer Key Research Questions? Describe, Explore, Explain...   



???
Depending on the pace of the group, if we do not finish today we will org anise a second session 

---

# Webinar rules

&lt;i class="fa fa-spinner fa-spin fa-fw fa-2x"&gt;&lt;/i&gt; Leverage this opportunity and make this session __lively__ - there's no stupid questions!

&lt;i class="fa fa-check-square fa-fw fa-2x"&gt;&lt;/i&gt; Use the __chat__ to send your questions - we are two facilitators and one is focused on replying all questions directly in the chat while the session is on-going

&lt;i class="fa fa-pencil  fa-fw fa-2x"&gt;&lt;/i&gt; No need to take notes, all the session __content__ will be shared 

&lt;i class="fa fa-cog fa-fw fa-2x"&gt;&lt;/i&gt; All practical exercises are designed to get you __testing the commands__:

&gt; Login on a dedicated cloud-based version of RStudio with base packages pre-installed for this session @ 
    
&gt; Paste the command from the chat to your online Rstudio session and check what is happening
    
&gt; In case it is not working as expected, share screenshot or error messages from the console in the chat


---

# Click-based Workflow...


.pull-left[

Associate data  with other tables with **ACCESS** ![](images/Logo_Microsoft_Access_2013.png)

...then explore through graphs with **EXCEL** ![](images/Microsoft_Excel_2013_logo.svg.png) 

...then mapping with **ArcGIS** ![](images/ArcGIS.png)

]

.pull-right[

..then write up narratives in **WORD** ![](images/Microsoft_Word_logo.png) 

... and design a full document with **INDESIGN** ![](images/Adobe_InDesign_icon.png)

... or create an infographic with **ILLUSTRATOR** ![](images/Adobe_Illustrator_icon.png)
]



???
and eventually some VBA macros 

---

## ... coming up with challenges! 

As a coauthor/reader/peer reviewer, one would like to see the whole **research process** (_how we arrived to that conclusion_), rather than cooked manuscript with inserted tables/figures.


.pull-left[

What analysis is **behind the figure**? Did it accounts for [..._new last minute question_...] in the analysis? 
 
What **dataset** (_final vs preliminary version_) was used ? Were **outliers** identified? How did you **weight** your sample?

Oops, there is an error in the data. Can we **repeat the analysis**? And update quickly the figures, graphs and tables in the report and the presentation! 
]

.pull-right[
&gt; This consumes time and open space for errors...

![](images/exhausted.png)
]


???

When managing numerous analysis with data that may change and in a collaborative mode, this workflow is **not** the most effective. 

 *  Data are manipulated through "point-and-click" user interfaces that are not __captured__!
 *  Data are moving from a software to another (Excel, GIS, Word...) using different __formats__! 
 *  All results (figures, tables) are **manually** copied/pasted to the final publishing system...
 
---


# Science is '_show me_' - not '_trust me_'!

### Reproducible Research Manisfesto; aka the _"Ten Commandments"_ 

.pull-left[

For every result, **keep track** of how it was produced

**Avoid manual data manipulation** steps

**Archive** the exact versions of all external programs used

**Version control** all custom scripts

**Record all intermediate results**, when possible in standardized formats
]

.pull-right[

For analyses that include randomness, **note underlying random seeds**

Always **store raw data** behind plots

Generate hierarchical analysis output, allowing layers of increasing detail to be inspected

Connect **textual statements** to underlying results

Provide **public access** to scripts, runs, and results
]

---

## Enable a fully auditable workflow

As soon as all steps (i.e. **DATA + TIDYING + MODELING + VISUALS + NARRATIVE**) are done through **series of written commands recorded in scripts**:

 - when spotting error in the data, or using different dataset, one just need to adjust in the script and report will update automatically;
 
 - Data manipulation becomes be *de facto* fully documented (no more manual changes in Excel);

 - Analysis is self-explanatory and ready for any kind of collaborative review;

 - Customization are facilitated and allow to deliver  final product  with a professional branding and styling.
 

 
&gt; Analysis becomes streamlined and [reproducible](https://unhcr-americas.github.io/reproducibility)! 

&gt; A "collaboration mode" is enabled from the begining of the process! 

&gt; As your analysis can be reviewed, you become "covered"... 

???
 instead of **hundreds of mouse clicks**
See also http://muschellij2.github.io/summerR_2015/modules/module12.html
---

### Key Concept 1: From "click" to "script"

Using the right combination of packages, you can integrate all necessary data analysis steps into **scripts**:

.pull-left[

Data management (import, clean, recode, merge, reshape)

Data analysis (test, regression, multivariate analysis, etc...)
 
Data visualization (plot, map, graph...)

Writing up results (report and presentation generation)

]

.pull-right[

![](images/data-science-wrangle.png)

]


 

---


### Key Concept 2: Everything is an object &amp; Anything can be packaged....


.left-column[


![](images/design-cake3.png)


]

.right-column[


`Vectors` are a core single data structure, created with `c()`. 

`Data.frame` where each column is a vector, but adjacent vectors can hold different things

`Matrix` just like a data frame except it's all numeric

`List` are made of any dimension, mix and match

`Factors` are a special class that R uses for categorical variables, which also allows for value labeling and ordering.

`Functions` are object designed to transform one object in a new one

`Charts` are objects  designed to generate an image

`Models` are objects recording computation based on specific data 

]


???
Elements in a vector must be of the same type.
Reference link on [Manipulating data](http://www.cookbook-r.com/Manipulating_data/)


---


### Key Concept 3: Search, Test, Try...

.pull-left[

![](images/change.png)
]

.pull-right[

 Training / Certification on R language on [UNHCR Learn &amp; Connect- R training](https://unhcr.csod.com/ui/lms-learner-playlist/PlaylistDetails?playlistId=e90e2279-e3a4-4ef2-8b74-757f91d224b2) 

[`UnhcrDataPackage`]() contains a library of charts

stackoverflow

]


---
class: center, middle, inverse

# Practical Use Case 1 - Charting

### *My boss needs a slide with the main origin of Asylum Seekers and Refugees from Americas in this country... in 5 minutes....* &lt;i class="fa fa-exclamation-circle fa-fw fa-2x"&gt;&lt;/i&gt; 


---

## How to get to this chart in a couple of lines?

&lt;img src="presentation_files/figure-html/unnamed-chunk-1-1.png" width="80%" /&gt;

???
https://r4ds.had.co.nz/graphics-for-communication.html#figure-sizing 

---

### Create a project and install required packages

.pull-left[

```r
library(tidyverse)
library(scales)
library(unhcrdatapackage)
library(unhcRstyle)
library(readxl)
```
]

--

.pull-right[

]

---

### Get the data

.pull-left[

To get the data, multiple approach are possible:
 * Got to HDX or Refugee Data Finder to download the data and save them locally within 


```r
popdata &lt;- unhcrdatapackage::end_year_population_totals
```
]


--

.pull-right[
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;"&gt; Year &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; CountryOriginCode &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; CountryAsylumCode &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; CountryOriginName &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; CountryAsylumName &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; REF &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; IDP &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; ASY &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; OOC &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; STA &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; VDA &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1951 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; UKN &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; AUS &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Various / unknown &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Australia &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 180000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1951 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; UKN &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; AUT &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Various / unknown &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Austria &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 282000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1951 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; UKN &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; BEL &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Various / unknown &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Belgium &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 55000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1951 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; UKN &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; CAN &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Various / unknown &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Canada &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 168511 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1951 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; UKN &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; DNK &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Various / unknown &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Denmark &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1951 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; UKN &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; FRA &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Various / unknown &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; France &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 290000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]

---

### Reshape the data

.pull-left[

```r
int_displ &lt;- popdata %&gt;% 
  filter(Year &gt;=2010) %&gt;% 
  group_by(Year) %&gt;% 
  summarise(Refugees = sum(REF, na.rm = TRUE),
            `Asylum-seekers` = sum(ASY, na.rm = TRUE),
            `Venezuelans displaced abroad` = sum(VDA, na.rm = TRUE)) %&gt;% 
  pivot_longer(cols = c("Refugees", "Asylum-seekers", "Venezuelans displaced abroad"),
               values_to = "Number of displaced", names_to = "Population type")
```
]

--

.pull-right[
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;"&gt; Year &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Population type &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Number of displaced &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2010 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Refugees &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 10548900 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2010 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Asylum-seekers &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 835969 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2010 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Venezuelans displaced abroad &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2011 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Refugees &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 10403951 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2011 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Asylum-seekers &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 895692 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2011 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Venezuelans displaced abroad &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]

---

### Build the chart

.pull-left[

```r
*# Add data, map to the aesthetic and add a geom
ggplot(data = int_displ) +
  aes(x = Year, y=`Number of displaced`) +
  geom_col()
```
]

--

.pull-right[
&lt;img src="presentation_files/figure-html/unnamed-chunk-9-1.png" width="1800" /&gt;

]

---

### Build the chart

.pull-left[

```r
ggplot(data = int_displ) +
  aes(x = Year, y=`Number of displaced`) +
  geom_col() +
* # Rotate the axis for easier comparison
* coord_flip()
```
]

--

.pull-right[
&lt;img src="presentation_files/figure-html/unnamed-chunk-11-1.png" width="1800" /&gt;
]

---

### Build the chart

.pull-left[

```r
ggplot(data = int_displ) +
  aes(x = Year, y=`Number of displaced`) +
  geom_col() +
  coord_flip() + 
  
* # Aply unhcr_theme
* unhcr_theme()
```
]

--

.pull-right[
&lt;img src="presentation_files/figure-html/unnamed-chunk-13-1.png" width="1800" /&gt;
]


---

### Build the chart


.pull-left[


```r
ggplot(data = int_displ) +
  aes(x = Year, y=`Number of displaced`) +
  geom_col() +
  coord_flip() +
* # Keeps major and minor X gridlines see unhcr_theme doc
  unhcr_theme(grid = "Xx") + 
* # Add information about the graph and define active gridline in unhcr_theme
* labs(title = "Total number of international displacement",
*      subtitle = "Refugees, Asylum-seekers and Venezuelans displaced abroad from 2010 to 2019",
*      caption = "Source: UNHCR Data Finder")
```

]

--


.pull-right[

&lt;img src="presentation_files/figure-html/unnamed-chunk-15-1.png" width="1800" /&gt;

]

---

### Build the chart

.pull-left[


```r
ggplot(data = int_displ) +
  aes(x = Year, y=`Number of displaced`) +
* # Change color of bars
* geom_col(color = unhcr_blue) +
  coord_flip() +
  unhcr_theme(grid = "Xx") +  
  labs(title = "Total number of international displacement",
       subtitle = "Refugees, Asylum-seekers and Venezuelans displaced abroad from 2010 to 2019", 
       caption = "Source: UNHCR Data Finder") 
```

]

--

.pull-right[

&lt;img src="presentation_files/figure-html/unnamed-chunk-17-1.png" width="1800" /&gt;

]

---

### Build the chart

.pull-left[


```r
ggplot(data = int_displ) +
  aes(x = Year, y=`Number of displaced`) +
* # Change color of bars
* geom_col(fill = unhcr_blue) +
  coord_flip() +
  unhcr_theme(grid = "Xx") +  
  labs(title = "Total number of international displacement",
       subtitle = "Refugees, Asylum-seekers and Venezuelans displaced abroad from 2010 to 2019", 
       caption = "Source: UNHCR Data Finder") 
```

]

--


.pull-right[

&lt;img src="presentation_files/figure-html/unnamed-chunk-19-1.png" width="1800" /&gt;

]

---

### Build the chart

.pull-left[


```r
ggplot(data = int_displ) +
  aes(x = Year, y=`Number of displaced`) +
  geom_col(fill = unhcr_blue) +
  coord_flip() +
  unhcr_theme(grid = "Xx") +
  labs(title = "Total number of international displacement",
       subtitle = "Refugees, Asylum-seekers and Venezuelans displaced abroad\nfrom 2010 to 2019",
       caption = "Source: UNHCR Data Finder",
*      x = "") +
* # Clean subtitle and improve axis labeling and limits
* scale_y_continuous(labels = scales::label_number_si(),
*                    limits = c(NA, 30000000))
```
]

--

.pull-right[

&lt;img src="presentation_files/figure-html/unnamed-chunk-21-1.png" width="1800" /&gt;

]

---

### Build the chart


.pull-left[


```r
ggplot(data = int_displ) +
  aes(x = Year, y=`Number of displaced`) +
* # What if I want to show the different population type?
* geom_col(aes(fill = `Population type`)) +
  coord_flip() +
  unhcr_theme(grid = "Xx") +
  labs(title = "Total number of international displacement",
       subtitle = "Refugees, Asylum-seekers and Venezuelans displaced abroad\nfrom 2010 to 2019",
       caption = "Source: UNHCR Data Finder",
       x = "") +
  scale_y_continuous(labels = scales::label_number_si(),
                     limits = c(NA, 30000000))
```
]

--

.pull-right[

&lt;img src="presentation_files/figure-html/unnamed-chunk-23-1.png" width="1800" /&gt;

]

---

### Build the chart

.pull-left[


```r
ggplot(data = int_displ) +
  aes(x = Year, y=`Number of displaced`) +
  
* # colors and reorder classes to be more easily comparable
* geom_col(aes(fill = factor(`Population type`,
*                            levels = c("Venezuelans displaced abroad", "Asylum-seekers", "Refugees")))) +
  coord_flip() +
  unhcr_theme(grid = "Xx") +
  labs(title = "Total number of international displacement",
       subtitle = "Refugees, Asylum-seekers and Venezuelans displaced abroad\nfrom 2010 to 2019",
       caption = "Source: UNHCR Data Finder",
       x = "") +
  scale_y_continuous(labels = scales::label_number_si(),
                     limits = c(NA, 30000000)) +
* scale_fill_manual(values = usecol(pal = c(unhcr_green, unhcr_darkblue, unhcr_blue)))
```

]

--

.pull-right[

&lt;img src="presentation_files/figure-html/unnamed-chunk-25-1.png" width="1800" /&gt;

]


---

# The Grammar of graphics in 7 key syntax

.img75[![Structure of ggplot2](images/struct_ggplot.png)]
[@CedSherer](https://twitter.com/CedScherer/status/1229418108122783744?s=20)

???
**Data**
- Data is not just data
- Representation defines what can be done with it
- Grammar requires a tidy format (though it precedes the notion) 

**Aesthetics**
- Allow generic datasets to be understood by the graphic system.
- Link variables in data to graphical properties in the geometry.

**Layers**
1. Geom
    - How to interpret aesthetics as graphical representations
    - Is a progression of positional aesthetics a number of points, a line, a single polygon, or something else entirely?
2. Stats
    - Transform input variables to displayed values
    - Is implicit in many plot-types but can often be done prior to plotting

**Scales**
- A scale translate back and forth between variable ranges and property ranges
    - Categories &gt; Colour
    - Numbers &gt; Position

**Coordinates**
- Defines the physical mapping of the aesthetics to the paper 

**Facets**
- Define the number of panels with equal logic and split data among them…
- Small multiples 

**Themes**
- Theming spans every part of the graphic that is not linked to data

---


.pull-left[

### Insert this in a slide -  Report template....

All based on Rmarkdown that allow to create multiple outputs from the same content format.

- Powerpoint with UNHCR style

- Word with UNHCR style

- html/bootstrap -scroll-able report

- html/slide - slide-able report (WIP)

- Paginated report built on the top of pagedown.

- Analysis Repository contribution


]

.pull-right[

Access them **"From Template"** panel when creating a new Rmd document

![UNHCR Rmd templates](images/rmd_templates.png)

]



---
class: center, middle, inverse


# Practical Use Case 2 - Building impact indicators from Survey Data

### *The National Household Survey is including Forcibly Displaced People and got published yesterday... We need to report our indicators by tomorrow!  * &lt;i class="fa fa-exclamation-triangle fa-fw fa-2x"&gt;&lt;/i&gt; 


???



We will use the “Encuesta Nacional de Calidad de Vida ECV 2020” published by the National Office of Colombia (http://microdatos.dane.gov.co/index.php/catalog/718/get_microdata) and explore different type of statistical analysis based on an example of three research questions:


---

## Get the data


The dataset,  [Encuesta Nacional de Calidad de Vida ECV 2020, Colombia, DANE](http://microdatos.dane.gov.co/index.php/catalog/718/get_microdata) is available through a micro data library. The particularity of HH survey dataset, when stored in SPSS (`.sav`), SAS (`.sas7bdat`), or Stata (`.dta`) format is that they usually contains both values and __associated labels__ (we call them `labelled data`).

.pull-left[


```r
#  Packages             
if (!require("unhcRstyle")) remotes::install_github('unhcr-web/unhcRstyle')
if (!require("tidyverse")) install.packages("tidyverse", dependencies = TRUE)
if (!require("haven")) install.packages("haven", dependencies = TRUE)
if (!require("sjmisc")) install.packages("sjmisc", dependencies = TRUE)
if (!require("sjPlot")) install.packages("sjPlot", dependencies = TRUE)
if (!require("dplyr")) install.packages("dplyr", dependencies = TRUE)
if (!require("ggrepel")) install.packages("ggrepel", dependencies = TRUE)
if (!require("Hmisc")) install.packages("Hmisc", dependencies = TRUE)
if (!require("ggplot2")) install.packages("ggplot2", dependencies = TRUE)
if (!require("ggthemes")) install.packages("ggthemes", dependencies = TRUE)
if (!require("here")) install.packages("here", dependencies = TRUE)
library(tidyverse)
library(dplyr)
library(haven) 
library(sjlabelled)
library(sjmisc) 
library(sjPlot)
library(ggrepel)
library(Hmisc)
library(ggplot2)
library(ggthemes)
library(here)
# http://microdatos.dane.gov.co/index.php/catalog/718/get_microdata 
## Start with Household composition where disaggregation variables are
data0 &lt;- haven::read_sav(here::here("data-raw", "Características y composición del hogar.sav"))

# Multiple labelled files shall first be merged together.  
data1 &lt;- haven::read_sav(here::here("data-raw", "Condiciones de vida del hogar y tenencia de bienes.sav"))
data &lt;- dplyr::left_join(data0, data1, by = c("DIRECTORIO", "SECUENCIA_ENCUESTA", "SECUENCIA_P",       
                                              "ORDEN", "FEX_C" ) )


# create data dictionary 
dictionary &lt;- labelled::generate_dictionary(data)

## Display frame content
data %&gt;% 
       sjPlot::view_df()
```
]

--

.pull-right[
&lt;table style="border-collapse:collapse; border:none;"&gt;
&lt;caption&gt;Data frame: .&lt;/caption&gt;
&lt;tr&gt;
&lt;th style="border-bottom:double; font-style:italic; font-weight:normal; padding:0.2cm; text-align:left; vertical-align:top;"&gt;ID&lt;/th&gt;&lt;th style="border-bottom:double; font-style:italic; font-weight:normal; padding:0.2cm; text-align:left; vertical-align:top;"&gt;Name&lt;/th&gt;&lt;th style="border-bottom:double; font-style:italic; font-weight:normal; padding:0.2cm; text-align:left; vertical-align:top;"&gt;Label&lt;/th&gt;&lt;th style="border-bottom:double; font-style:italic; font-weight:normal; padding:0.2cm; text-align:left; vertical-align:top;"&gt;Values&lt;/th&gt;&lt;th style="border-bottom:double; font-style:italic; font-weight:normal; padding:0.2cm; text-align:left; vertical-align:top;"&gt;Value Labels&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;1&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;DIRECTORIO&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;Directorio&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;" colspan="2"&gt;&lt;em&gt;range: 7247300-7407013&lt;/em&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;2&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;SECUENCIA_ENCUESTA&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;Secuencia_encuesta&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee" colspan="2"&gt;&lt;em&gt;range: 1-22&lt;/em&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;3&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;SECUENCIA_P&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;Secuencia_p&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;" colspan="2"&gt;&lt;em&gt;range: 1-4&lt;/em&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;4&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;ORDEN&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;Orden&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee" colspan="2"&gt;&lt;em&gt;range: 1-22&lt;/em&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;5&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;FEX_C&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;Factor de expansión&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;" colspan="2"&gt;&lt;em&gt;range: 1.9-3061.6&lt;/em&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;6&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;P6016&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;Número de orden de la persona que proporciona la&lt;br&gt;información:&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee" colspan="2"&gt;&lt;em&gt;range: 1-18&lt;/em&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;7&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;P1894&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;Tipo de documento de identidad&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;1&lt;br&gt;2&lt;br&gt;3&lt;br&gt;4&lt;br&gt;5&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;Registro civil de nacimiento&lt;br&gt;Tarjeta de identidad&lt;br&gt;Cédula de ciudadanía&lt;br&gt;Cédula de extranjería&lt;br&gt;No tiene documento de identidad&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;8&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;P6020&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;Sexo&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;1&lt;br&gt;2&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;Hombre&lt;br&gt;Mujer&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;9&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;P6034&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;¿Cuál es la fecha de nacimiento de _____?&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;" colspan="2"&gt;&lt;em&gt;range: 1-2&lt;/em&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;10&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;P6040&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;¿cuántos años cumplidos tiene...?&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee" colspan="2"&gt;&lt;em&gt;range: 0-106&lt;/em&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;11&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;P6051&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;Cuál es el parentesco de....con el jefe o la jefa&lt;br&gt;de este hogar?&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;1&lt;br&gt;2&lt;br&gt;3&lt;br&gt;4&lt;br&gt;5&lt;br&gt;6&lt;br&gt;7&lt;br&gt;8&lt;br&gt;9&lt;br&gt;10&lt;br&gt;11&lt;br&gt;12&lt;br&gt;13&lt;br&gt;14&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;Jefe (a) del hogar&lt;br&gt;Pareja, esposo (a), cónyuge, compañero(a)&lt;br&gt;Hijo(a) hijastro(a)&lt;br&gt;Nieto (a)&lt;br&gt;Padre, madre, padrastro y madrastra&lt;br&gt;Suegro o suegra&lt;br&gt;Hermano (a), hermanastro (a)&lt;br&gt;Yerno, nuera&lt;br&gt;Otro pariente del jefe(a)&lt;br&gt;Empleado(a) del servicio doméstico&lt;br&gt;Parientes del servicio doméstico&lt;br&gt;Trabajador&lt;br&gt;Pensionista&lt;br&gt;Otro pariente&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;12&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;P5502&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;Actualmente…:&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;1&lt;br&gt;2&lt;br&gt;3&lt;br&gt;4&lt;br&gt;5&lt;br&gt;6&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt; No está casado(a) y vive en pareja hace menos de dos años&lt;br&gt;No está casado(a) y vive en pareja hace dos años o más&lt;br&gt; Está viudo(a)&lt;br&gt;Está separado(a) o divorciado(a)&lt;br&gt; Está soltero(a)&lt;br&gt; Está casado(a)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;13&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;P6071&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;El (la) cónyuge de .. vive en este hogar&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;1&lt;br&gt;2&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;Sí&lt;br&gt;No&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;14&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;P6071S1&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;No de orden&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee" colspan="2"&gt;&lt;em&gt;range: 1-19&lt;/em&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;15&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;P756&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;¿Dónde nació  ________?&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;1&lt;br&gt;2&lt;br&gt;3&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;En este municipio&lt;br&gt;En otro municipio&lt;br&gt;En otro país&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;16&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;P756S1&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;Departamento&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee" colspan="2"&gt;&lt;em&gt;range: 5-99&lt;/em&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;17&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;P756S2&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;Municipio&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;" colspan="2"&gt;&lt;em&gt;range: 5001-99773&lt;/em&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;18&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;P756S3&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;En otro país&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;1&lt;br&gt;2&lt;br&gt;3&lt;br&gt;4&lt;br&gt;5&lt;br&gt;6&lt;br&gt;7&lt;br&gt;8&lt;br&gt;9&lt;br&gt;10&lt;br&gt;11&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;Estados Unidos&lt;br&gt;España&lt;br&gt;Venezuela&lt;br&gt;Ecuador&lt;br&gt;Panamá&lt;br&gt;Perú&lt;br&gt;Costa Rica&lt;br&gt;Argentina&lt;br&gt;Francia&lt;br&gt;Italia&lt;br&gt;Otro país&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;19&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;P6074&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;¿_______________ siempre ha vivido aquí en este&lt;br&gt;municipio?&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;1&lt;br&gt;2&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;Sí&lt;br&gt;No&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;20&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;P767&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;¿cuántos años continuos hace que vive ___ aquí en&lt;br&gt;este municipio?&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee" colspan="2"&gt;&lt;em&gt;range: 0-90&lt;/em&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;21&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;P6076&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;Antes de venir a este municipio_______________&lt;br&gt;vivía en&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;1&lt;br&gt;2&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;Otro país&lt;br&gt;Otro municipio&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;22&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;P6076S1&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;Departamento&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;23&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;P6076S2&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;Municipio
&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;24&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;P6077&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;_____ vivía en&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;1&lt;br&gt;2&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;El centro urbano donde está la alcaldía&lt;br&gt;Un corregimiento, inspección de policía, caserío, vereda o c&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;25&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;P6096&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;¿cuál fue la razón principal para cambiar la&lt;br&gt;residencia al municipio actual?&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;1&lt;br&gt;2&lt;br&gt;3&lt;br&gt;4&lt;br&gt;5&lt;br&gt;6&lt;br&gt;7&lt;br&gt;8&lt;br&gt;9&lt;br&gt;10&lt;br&gt;11&lt;br&gt;12&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt; Dificultad para encontrar trabajo o ausencia de medios de s&lt;br&gt; Riesgo o consecuencia de desastre natural (inundación, aval&lt;br&gt;Amenaza o riesgo para su vida, su libertad o su integridad f&lt;br&gt; Necesidad de educación&lt;br&gt;Porque se casó o formó pareja&lt;br&gt; Motivos de salud&lt;br&gt; Mejorar la vivienda o localización&lt;br&gt; Mejores oportunidades laborales o de negocio&lt;br&gt;Acompañar a otro(s) miembro(s) del hogar&lt;br&gt;Adquisición de vivienda&lt;br&gt;Búsqueda de tranquilidad o mejor calidad de vida&lt;br&gt; Otra&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;26&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;P6081&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;El padre de .. vive en este hogar&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;1&lt;br&gt;2&lt;br&gt;3&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;Sí&lt;br&gt;No&lt;br&gt;Fallecido&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;27&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;P6081S1&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;No. De orden&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;" colspan="2"&gt;&lt;em&gt;range: 1-15&lt;/em&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;28&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;P6087&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;¿cuál es o fue el nivel de educación más alto&lt;br&gt;alcanzado por el padre de…..?&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;1&lt;br&gt;2&lt;br&gt;3&lt;br&gt;4&lt;br&gt;5&lt;br&gt;6&lt;br&gt;7&lt;br&gt;8&lt;br&gt;9&lt;br&gt;10&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;Algunos años de primaria&lt;br&gt;Toda la primaria&lt;br&gt;Algunos años de secundaria&lt;br&gt;Toda la secundaria&lt;br&gt;Uno o mas años de técnica o tecnológica&lt;br&gt;Técnica o tecnológica completa&lt;br&gt;Uno o mas años de universidad&lt;br&gt;Universitaria completa&lt;br&gt;Ninguno&lt;br&gt;No sabe&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;29&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;P6083&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;La madre de .. vive en este hogar&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;1&lt;br&gt;2&lt;br&gt;3&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;Sí&lt;br&gt;No&lt;br&gt;Fallecida&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;30&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;P6083S1&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;No. De orden&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee" colspan="2"&gt;&lt;em&gt;range: 1-18&lt;/em&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;31&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;P6088&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;¿cuál es o fue el nivel de educación más alto&lt;br&gt;alcanzado por la madre de......?&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;1&lt;br&gt;2&lt;br&gt;3&lt;br&gt;4&lt;br&gt;5&lt;br&gt;6&lt;br&gt;7&lt;br&gt;8&lt;br&gt;9&lt;br&gt;10&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;Algunos años de primaria&lt;br&gt;Toda la primaria&lt;br&gt;Algunos años de secundaria&lt;br&gt;Toda la secundaria&lt;br&gt;Uno o mas años de técnica o tecnológica&lt;br&gt;Técnica o tecnológica completa&lt;br&gt;Uno o mas años de universidad&lt;br&gt;Universitaria completa&lt;br&gt;Ninguno&lt;br&gt;No sabe&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;32&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;P6080&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;De acuerdo con su cultura, pueblo o rasgos&lt;br&gt;físicos, _____ es o se reconoce comó:&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;1&lt;br&gt;2&lt;br&gt;3&lt;br&gt;4&lt;br&gt;5&lt;br&gt;6&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;Indígena&lt;br&gt;Gitano (a) (rom)&lt;br&gt;Raizal del background-color:#eeeeeehipiélago de San Andrés, Providencia y Santa C&lt;br&gt;Palenquero (a) de San Basilio&lt;br&gt;Negro (a), mulato (a) (afrodescendiente), afrocolombiano(a)&lt;br&gt;Ninguno de los anteriores&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;33&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;P5667&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt; ¿a cuál pueblo o etnia indígena pertenece _____?&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;34&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;P2057&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;¿Usted se considera campesino(a)?&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;1&lt;br&gt;2&lt;br&gt;3&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;Si&lt;br&gt;No&lt;br&gt;No informa&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;35&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;P2059&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt; ¿Usted considera que alguna vez fue campesino(a)?&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;1&lt;br&gt;2&lt;br&gt;3&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;Si&lt;br&gt;No&lt;br&gt;No informa&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;36&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;P2061&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt; ¿Usted considera que la comunidad en que vive es&lt;br&gt;campesina?&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;1&lt;br&gt;2&lt;br&gt;3&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;Si&lt;br&gt;No&lt;br&gt;No informa&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;37&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;P1895&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;En general, qué tan satisfecho(a) se siente ...&lt;br&gt;con su vida actualmente?&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;0&lt;br&gt;1&lt;br&gt;2&lt;br&gt;3&lt;br&gt;4&lt;br&gt;5&lt;br&gt;6&lt;br&gt;7&lt;br&gt;8&lt;br&gt;9&lt;br&gt;10&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;Totalmente insatisfecho(a)&lt;br&gt;1&lt;br&gt;2&lt;br&gt;3&lt;br&gt;4&lt;br&gt;5&lt;br&gt;6&lt;br&gt;7&lt;br&gt;8&lt;br&gt;9&lt;br&gt;Totalmente satisfecho(a)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;38&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;P1896&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;En general, qué tan satisfecho(a) se siente ...&lt;br&gt;con su ingreso actualmente?&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;0&lt;br&gt;1&lt;br&gt;2&lt;br&gt;3&lt;br&gt;4&lt;br&gt;5&lt;br&gt;6&lt;br&gt;7&lt;br&gt;8&lt;br&gt;9&lt;br&gt;10&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;Totalmente insatisfecho(a)&lt;br&gt;1&lt;br&gt;2&lt;br&gt;3&lt;br&gt;4&lt;br&gt;5&lt;br&gt;6&lt;br&gt;7&lt;br&gt;8&lt;br&gt;9&lt;br&gt;Totalmente satisfecho(a)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;39&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;P1897&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;En general, qué tan satisfecho(a) se siente ...&lt;br&gt;con su salud actualmente?&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;0&lt;br&gt;1&lt;br&gt;2&lt;br&gt;3&lt;br&gt;4&lt;br&gt;5&lt;br&gt;6&lt;br&gt;7&lt;br&gt;8&lt;br&gt;9&lt;br&gt;10&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;Totalmente insatisfecho(a)&lt;br&gt;1&lt;br&gt;2&lt;br&gt;3&lt;br&gt;4&lt;br&gt;5&lt;br&gt;6&lt;br&gt;7&lt;br&gt;8&lt;br&gt;9&lt;br&gt;Totalmente satisfecho(a)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;40&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;P1898&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;En general, qué tan satisfecho(a) se siente ...&lt;br&gt;con su nivel de seguridad actualmente?&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;0&lt;br&gt;1&lt;br&gt;2&lt;br&gt;3&lt;br&gt;4&lt;br&gt;5&lt;br&gt;6&lt;br&gt;7&lt;br&gt;8&lt;br&gt;9&lt;br&gt;10&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;Totalmente insatisfecho(a)&lt;br&gt;1&lt;br&gt;2&lt;br&gt;3&lt;br&gt;4&lt;br&gt;5&lt;br&gt;6&lt;br&gt;7&lt;br&gt;8&lt;br&gt;9&lt;br&gt;Totalmente satisfecho(a)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;41&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;P1899&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;En general, qué tan satisfecho(a) se siente ...&lt;br&gt;con su trabajo/actividad actualmente?&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;0&lt;br&gt;1&lt;br&gt;2&lt;br&gt;3&lt;br&gt;4&lt;br&gt;5&lt;br&gt;6&lt;br&gt;7&lt;br&gt;8&lt;br&gt;9&lt;br&gt;10&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;Totalmente insatisfecho(a)&lt;br&gt;1&lt;br&gt;2&lt;br&gt;3&lt;br&gt;4&lt;br&gt;5&lt;br&gt;6&lt;br&gt;7&lt;br&gt;8&lt;br&gt;9&lt;br&gt;Totalmente satisfecho(a)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;42&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;P3175&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt; En general, ¿qué tan satisfecho/a se siente _____&lt;br&gt;con su tiempo libre?&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;0&lt;br&gt;1&lt;br&gt;2&lt;br&gt;3&lt;br&gt;4&lt;br&gt;5&lt;br&gt;6&lt;br&gt;7&lt;br&gt;8&lt;br&gt;9&lt;br&gt;10&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;Totalmente insatisfecho(a)&lt;br&gt;1&lt;br&gt;2&lt;br&gt;3&lt;br&gt;4&lt;br&gt;5&lt;br&gt;6&lt;br&gt;7&lt;br&gt;8&lt;br&gt;9&lt;br&gt;Totalmente satisfecho(a)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;43&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;P1901&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt; ¿qué tan feliz se sintió ... el día de ayer?&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;0&lt;br&gt;1&lt;br&gt;2&lt;br&gt;3&lt;br&gt;4&lt;br&gt;5&lt;br&gt;6&lt;br&gt;7&lt;br&gt;8&lt;br&gt;9&lt;br&gt;10&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;Para nada feliz&lt;br&gt;1&lt;br&gt;2&lt;br&gt;3&lt;br&gt;4&lt;br&gt;5&lt;br&gt;6&lt;br&gt;7&lt;br&gt;8&lt;br&gt;9&lt;br&gt;Todo el tiempo feliz&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;44&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;P1903&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;¿qué tan preocupado(a) se sintió ... el día de&lt;br&gt;ayer?&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;0&lt;br&gt;1&lt;br&gt;2&lt;br&gt;3&lt;br&gt;4&lt;br&gt;5&lt;br&gt;6&lt;br&gt;7&lt;br&gt;8&lt;br&gt;9&lt;br&gt;10&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;Para nada  preocupado(a)&lt;br&gt;1&lt;br&gt;2&lt;br&gt;3&lt;br&gt;4&lt;br&gt;5&lt;br&gt;6&lt;br&gt;7&lt;br&gt;8&lt;br&gt;9&lt;br&gt;Todo el tiempo preocupado(a)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;45&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;P1904&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;¿qué tan triste se sintió ... el día de ayer?&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;0&lt;br&gt;1&lt;br&gt;2&lt;br&gt;3&lt;br&gt;4&lt;br&gt;5&lt;br&gt;6&lt;br&gt;7&lt;br&gt;8&lt;br&gt;9&lt;br&gt;10&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;Para nada  triste&lt;br&gt;1&lt;br&gt;2&lt;br&gt;3&lt;br&gt;4&lt;br&gt;5&lt;br&gt;6&lt;br&gt;7&lt;br&gt;8&lt;br&gt;9&lt;br&gt;Todo el tiempo triste&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;46&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;P1905&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;Qué tanto considera ... que las cosas que hace en&lt;br&gt;su vida valen la pena?&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;0&lt;br&gt;1&lt;br&gt;2&lt;br&gt;3&lt;br&gt;4&lt;br&gt;5&lt;br&gt;6&lt;br&gt;7&lt;br&gt;8&lt;br&gt;9&lt;br&gt;10&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top; background-color:#eeeeee"&gt;No valen la pena&lt;br&gt;1&lt;br&gt;2&lt;br&gt;3&lt;br&gt;4&lt;br&gt;5&lt;br&gt;6&lt;br&gt;7&lt;br&gt;8&lt;br&gt;9&lt;br&gt;Valen totalmente la pena&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;47&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;P1927&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;¿En cuál escalón diría usted que se encuentra&lt;br&gt;parado(a) en este momento?&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;0&lt;br&gt;1&lt;br&gt;2&lt;br&gt;3&lt;br&gt;4&lt;br&gt;5&lt;br&gt;6&lt;br&gt;7&lt;br&gt;8&lt;br&gt;9&lt;br&gt;10&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:left; vertical-align:top;"&gt;Peor vida&lt;br&gt;1&lt;br&gt;2&lt;br&gt;3&lt;br&gt;4&lt;br&gt;5&lt;br&gt;6&lt;br&gt;7&lt;br&gt;8&lt;br&gt;9&lt;br&gt;Mejor vida&lt;/td&gt;
&lt;/tr&gt;

&lt;/table&gt;
]

???
https://www.pipinghotdata.com/posts/2020-12-23-leveraging-labelled-data-in-r/ 

## Look what is inside the frame


.pull-left[


```r
# create data dictionary  
dictionary &lt;- labelled::generate_dictionary(data0)
View(dictionary)
```
]

--

.pull-right[
 
]

???
 


---

## Simple plot with labelled data

.pull-left[


```r
sjPlot::plot_frq(data0$P756S3, 
                            type = "bar",
                            sort.frq =  "asc",
                            coord.flip = TRUE,
                            weight.by = as.vector(data0$FEX_C),
                            show.ci = TRUE,
                            geom.colors =  unhcRstyle::unhcr_blue) +
      scale_y_continuous(labels = scales::label_number_si()) +
  
      unhcRstyle::unhcr_theme(base_size = 8)  + ## Insert UNHCR Style
      theme(legend.position = "none",
            panel.grid.major.x  = element_line(color = "#cbcbcb"), 
            panel.grid.major.y  = element_blank(), 
            panel.grid.minor = element_blank()) + ### changing grid line that should appear
      ## and the chart labels
      labs(title = paste0(sjlabelled::get_label(data0$P756S3)),
           x = "",
           y = "",
           caption = "Source: Encusta Nacional de Calidad de Vida ECV 2020, Colombia, DANE")
```
]

--

.pull-right[
&lt;img src="presentation_files/figure-html/unnamed-chunk-30-1.png" width="1080" /&gt;
]

???
 

---

## Join data frame

.pull-left[




```r
# read data based on a list of files in a folder with a specific extension (i.e. sav)
# all the dataset will be stored in a list object
datasets &lt;- fs::dir_ls(here::here("data-raw"), 
                       glob = "*.sav") %&gt;% 
            map(compose(as_factor, haven::read_sav))

# Bind together datasets with the same unit of analysis
persons &lt;- datasets %&gt;% 
           keep(~!all(.$SECUENCIA_P == 1) &amp;
                  !all(.$SECUENCIA_ENCUESTA == 1)) %&gt;% 
           reduce(full_join)

households &lt;- datasets %&gt;% 
              keep(~all(.$SECUENCIA_P == 1) &amp; 
                     !all(.$SECUENCIA_ENCUESTA == 1)) %&gt;% 
              reduce(full_join)


# harmonize key variables - 
# notice how SECUENCIA_ENCUESTA changes meaning between datasets
persons &lt;- persons %&gt;% 
           rename(dwelling = DIRECTORIO, 
                  household = SECUENCIA_P, 
                  person = SECUENCIA_ENCUESTA)

households &lt;- households %&gt;% 
              rename(dwelling = DIRECTORIO, 
                     household = SECUENCIA_ENCUESTA) %&gt;% 
              select(-ORDEN)
```
]

--

.pull-right[

]

???
 

---

## Perform calculations

.pull-left[


```r
data &lt;-  
  left_join(persons, households) %&gt;% 
  transmute(pop = case_when(is.na(P756S3) ~ "Colombians",
                            P756S3 == "Venezuela" ~ "Venezuelans",
                            TRUE ~ "Others"))

indicators &lt;-  
  left_join(persons, households) %&gt;% 
  transmute(pop = case_when(is.na(P756S3) ~ "Colombians",
                            P756S3 == "Venezuela" ~ "Venezuelans",
                            TRUE ~ "Others"),
            
            # 2.1 Proportion of PoC living below the national poverty line
            rbm2.1 = PERCAPITA &lt; 327674, 
            
            water = P792 != "No tienen el servicio",
            sanitation = P5032 != "No tienen el servicio",
            overcrowding = CANT_PERSONAS_HOGAR/P5000 &gt; 3,
            secure_tenure = 
              P5095 == "Propia, totalmente pagada" |
              P5095 == "Propia, lo están pagando" |
              (P5095 == "En arriendo o subarriendo" &amp; P3006 == "Escrito"),
            housing_durability = TRUE, # FIXME: correct when we get the missing data file
       
            # 2.2 Proportion of PoCs residing in physically safe and secure settlements 
            # with access to basic facilities
            rbm2.2 = water &amp; sanitation &amp; !overcrowding &amp; housing_durability &amp; secure_tenure,
            
            # 2.3 Proportion of PoC with access to health services
            rbm2.3 = if_else(P5665 == "Sí", is.na(P6153), NA),
            dpto = "dummy", # FIXME: should be dwellings$dpto,
            wt = FEX_C)  %&gt;%
         
         ## Remove the neither colombian nor venezuelan
         filter(pop != "Others") %&gt;% 
         
         ## transform in a srvey weighter dataset
         srvyr::as_survey_design(strata = dpto, 
                          weights = wt) %&gt;% 
         ## Compile indicators by group
         group_by(pop) %&gt;% 
         summarize(across(contains("rbm"), 
                          srvyr::survey_mean, 
                          vartype = "ci", 
                          na.rm = TRUE,
                          .names = "{.col}_est")) %&gt;% 
         pivot_longer(-pop, 
                      names_to = c("ind", ".value"), 
                      names_pattern = "(.+?)_(.+)")
```
]

--

.pull-right[

]

???
 

---

## Generate a chart

.pull-left[


```r
## Add labels for each calculated indicators
rbm_indicaors &lt;- 
  c(rbm2.1 = "2.1 Proportion of PoC living below the national poverty line",
    rbm2.2 = "2.2 Proportion of PoCs residing in physically safe and secure settlements with access to basic facilities.",
    rbm2.3 = "2.3 Proportion of PoC with access to health services")


ggplot( data = indicators,
  aes(est, fct_rev(ind))) +
  geom_pointrange(aes(xmin = est_low, 
                      xmax = est_upp, 
                      color = pop), 
                  size = .75) +
  geom_text(aes(label = scales::label_percent(.1)(est)), 
                 vjust = -1.25) +
  scale_x_continuous(labels = scales::label_percent(), 
                     limits = c(0, 1), 
                     breaks = c(0, .5, 1)) +
  scale_y_discrete(labels = str_wrap(rev(rbm_indicaors), 40)) +
  scale_color_manual(values = c(Colombians = "black", Venezuelans = "#0072BC")) +
  labs(x = "estimate", 
       y = "indicator",
       title = "Impact Area 2: Realizing Rights in Safe Environments",
       caption = glue::glue("Encuesta Nacional de Calidad de Vida (ECV) 2020\n",
                            "# of Venezuelans = {scales::label_comma()(sum(data$pop=='Venezuelans'))} obs. ",
                            "({scales::label_number_si(.1)(sum((data$pop=='Venezuelans')*data$wt))} weighted)")) +
  unhcRstyle::unhcr_theme() +
  theme(panel.grid.minor.x = element_blank())
```
]

--

.pull-right[
&lt;img src="presentation_files/figure-html/unnamed-chunk-36-1.png" width="1080" /&gt;
]

???
 


   
---
class: center, middle, inverse


# Practical Use Case 3 - Evidence for key research question

### * What programmatic assumptions do we have evidences for? Describe, Explore, Explain...  *  &lt;i class="fa fa-eye fa-fw fa-2x"&gt;&lt;/i&gt; 


---

## Statistical association analysis: Crosstabulation &amp; Assocation


&gt; __Question__: How is the perception of current situation compared to that of 5 years ago differs between the "undocumented Venezuelans" and the rest of the population? 


.pull-left[


```r
# data$IllegalVenez &lt;- ifelse( (data$P1894 == 5 &amp; data$P756S3 == 3), paste("Venz_SinDocumento"), paste("other"))
# cross &lt;- c("IllegalVenez")
# i &lt;- 55
# 
# sjPlot::plot_xtab(x= data[[i]],
#                                grp = data[[cross]],
#                                type = "bar",
#                                weight.by = weight,
#                                # sort.frq =  "asc",
#                                # bar.pos = "stack",
#                                wrap.labels = 40,
#                                show.n = FALSE,
#                                show.total = FALSE,
#                                show.summary = TRUE,
#                                show.prc = FALSE,
#                                summary.pos = "r",
#                                coord.flip = TRUE) +
#         #unhcRstyle::unhcr_theme(base_size = 8)  + ## Insert UNHCR Style
#         theme(#legend.position = "none",
#               panel.grid.major.x  = element_line(color = "#cbcbcb"),
#               panel.grid.major.y  = element_blank(),
#               panel.grid.minor = element_blank()) + ### changing grid line that should appear
#         ## and the chart labels
#         labs(title = paste0(sjlabelled::get_label(data[i])),
#              subtitle = paste0("Crossed with ", cross),
#              x = "",
#              y = "",
#              caption = "Source: Encuesta Nacional de Calidad de Vida ECV 2020, Colombia, DANE")
```
]

--

.pull-right[

]

???

---

## Regression analysis between a target variable and multiple predictors
&gt; __Question__: What can explain why some "undocumented Venezuelans" feel worse now than five years ago? 
 

---

## Clustering analysis to identify a homogeneous group of individuals based on multiple variables

&gt; __Question__: What are the main profiles of "undocumented Venezuelans" who have a worse situation now than 5 years ago? 
  
   

---
class: left, top

# Good luck in your R journey!

### Reach out to us for questions, analysis mentoring or code peer review!


.pull-left[

__DIMA Americas__: &lt;br&gt;
Edouard Legoupil, _Snr Statistics &amp; Data Analysis Officer_, &lt;a href="mailto:legoupil@unhcr.org"&gt;&lt;i class="fa fa-paper-plane fa-fw"&gt;&lt;/i&gt;&amp;nbsp; legoupil@unhcr.org&lt;/a&gt; | &lt;a href="http://twitter.com/edouard_lgp"&gt;&lt;i class="fa fa-twitter fa-fw"&gt;&lt;/i&gt;&amp;nbsp; @edouard_lgp&lt;/a&gt; &lt;br&gt; 
Hisham Galal, _Associate Statistics &amp; Data Analysis Officer_, &lt;a href="mailto:galal@unhcr.org"&gt;&lt;i class="fa fa-paper-plane fa-fw"&gt;&lt;/i&gt;&amp;nbsp; galal@unhcr.org&lt;/a&gt;


Check our github @ &lt;a href="http://github.com/unhcr-americas"&gt;&lt;i class="fa fa-github fa-fw"&gt;&lt;/i&gt;&amp;nbsp;unhcr-americas&lt;/a&gt;  and learn about __UnhcRverse packages__&lt;br&gt;

Slides created with [**remark.js**](http://remarkjs.com/) and the R package [**xaringan**](https://github.com/yihui/xaringan). Slides notes for this presentation can be displayed by pressing keyboard shortcut `p` - Navigation help with keyboard shortcut `h`


]

.pull-right[

&lt;img src="images/giphy.gif" width="310px"/&gt;

]


???



Last, we hope that this session will motivate you to join the vibrant R users community in UNHCR and soon become an R champion. In order to make the most of the session, we would advise you to install the following open source environment: 

    R - https://cran.r-project.org/bin/windows/base/ 

    Rstudio Free version: https://www.rstudio.com/products/rstudio/download/ 

    Create an account on Github - https://github.com/join?  and install Github desktop https://desktop.github.com/ 

You may also start installing UNHCR Packages – following the instruction in their respective documentation published on Github: 

    Use UNHCR Open data  - https://unhcr.github.io/unhcrdatapackage/docs/  

    API to connect to internal data source - https://unhcr-web.github.io/hcrdata/docs/ 

    Perform High Frequency Check https://unhcr.github.io/HighFrequencyChecks/docs/ 

    Process data crunching for survey dataset - https://unhcr.github.io/koboloadeR/docs/  

    Use UNHCR graphical template- https://unhcr-web.github.io/unhcRstyle/docs/ 

See some practical tutorial on https://humanitarian-user-group.github.io/  

The best way to start and learn is to have a concrete project! If you have one and need mentoring, we can liaise after the session. 

Resources Ggplot:

- [Ggplot main doc](https://ggplot2.tidyverse.org/index.html)
- [The ggplot flipbook](https://evamaerey.github.io/ggplot_flipbook/ggplot_flipbook_xaringan.html#1) by Gina Reynolds
- [A ggplot2 tutorial for beautiful plotting in R](https://www.cedricscherer.com/2019/08/05/a-ggplot2-tutorial-for-beautiful-plotting-in-r/) and [ggplot Wizardry Hands-On](https://z3tt.github.io/OutlierConf2021/) by Cedric Scherer
- Ggplot workshop [Part1](https://www.youtube.com/watch?v=h29g21z0a68)/[Part2](https://www.youtube.com/watch?v=0m4yywqNPVY) by Thomas Lin Pedersen (one of the main maintainer of ggplot)


 
 packages extension for ggplot

- Patchwork to bind multiple plots on one

- Gganimate to create simple animation

- Ggtext and ggrepel to deal with annotation and text style

- Ggforce to group some content visually

- and much more.... just go out there and experiment


    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
